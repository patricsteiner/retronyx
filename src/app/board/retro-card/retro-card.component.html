<ion-card>
  <div class="background">
    {{ retroCard.emoji }}
  </div>
  <ion-card-header *ngIf="retroCard.title">
    <ion-card-title
      >{{ retroCard.title }}
      <ion-button
        (click)="showEditCardPopup(retroCard.title, retroCard.emoji)"
        size="small"
        shape="round"
        fill="none"
        style="float: right;"
      >
        <ion-icon color="medium" name="ellipsis-horizontal"></ion-icon>
      </ion-button>
    </ion-card-title>
  </ion-card-header>
  <ion-card-content>
    <ion-list>
      <ion-item-sliding *ngFor="let item of retroCard.items; let itemIdx = index" #slidingItem>
        <ion-item *ngIf="!item.deleted">
          <ion-chip class="user" [ngStyle]="{ background: item.user | colorHash }">
            <ion-label [ngStyle]="{ color: item.user | colorHash: true }" title="{{ item.user || 'Unbekannt' }}">{{
              item.user || 'Unbekannt'
            }}</ion-label>
          </ion-chip>
          <ion-label class="ion-text-wrap item">{{ item.text }}</ion-label>
          <ion-icon *ngIf="item.flag" name="flag" color="danger"></ion-icon>
          <ion-chip class="likes" outline="true" (click)="toggleLike(itemIdx)" [title]="item.likes">
            <ion-label>{{ item.likes.length }}</ion-label>
            <ng-container *ngIf="item.likes.includes(username); then heart; else heartOutline"></ng-container>
            <ng-template #heart>
              <ion-icon name="heart" color="danger"></ion-icon>
            </ng-template>
            <ng-template #heartOutline>
              <ion-icon name="heart-outline" color="danger"></ion-icon>
            </ng-template>
          </ion-chip>
        </ion-item>
        <ion-item-options side="start">
          <ion-item-option color="light" (click)="toggleFlag(itemIdx); slidingItem.close()">
            <ion-icon *ngIf="item.flag" slot="icon-only" name="flag-outline"></ion-icon>
            <ion-icon *ngIf="!item.flag" slot="icon-only" name="flag"></ion-icon>
          </ion-item-option>
        </ion-item-options>
        <ion-item-options side="end">
          <ion-item-option color="danger" (click)="deleteItem(itemIdx)">
            <ion-icon slot="icon-only" name="trash"></ion-icon>
          </ion-item-option>
        </ion-item-options>
      </ion-item-sliding>
      <ion-item>
        <ion-input
          placeholder="Eintrag hinzufÃ¼gen..."
          [(ngModel)]="itemText"
          (keydown.enter)="submit()"
          maxlength="200"
          minlength="2"
        ></ion-input>
        <ion-fab-button
          id="submit"
          slot="end"
          color="primary"
          size="small"
          [disabled]="!itemText || itemText.trim().length === 0"
          (click)="submit()"
        >
          <ion-icon name="add"></ion-icon>
        </ion-fab-button>
      </ion-item>
    </ion-list>
  </ion-card-content>
</ion-card>
